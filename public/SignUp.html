<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up</title>
    <link rel="stylesheet" href="index.css">
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
</head>
<body>

    <header class="header">
        <a href="home.html" class="logo">
        <span>Attendify</span></a>

        <i class='bx bx-menu' id="menu-icon"></i>

        <nav class="navbar">
            <a href="./home.html" > Home</a>
            <a href="./Loginpage.html" > Log in</a>
            <a href="./SignUp.html" class="active"> Sign Up</a>
            <a href="./profile.html" > Profile</a>
            <a href="./contactUs.html">Contact Us</a>
        </nav>
    </header>

    <div class="signpage">
        <div class="SignPage">
            <!--<video class="background-video" src="images/video.mp4" autoplay muted loop></video> -->
            <form id="signUpForm">
                <!-- Username -->
                <div class="formgroup">
                    <label for="username">Name</label>
                    <input type="text" id="username" name="username" required>
                </div>

                <!-- Surname -->
                <div class="formgroup">
                    <label for="surname">Surname</label>
                    <input type="text" id="surname" name="surname" required>
                </div>

                <!-- Student ID -->
                <div class="formgroup">
                    <label for="studentId">Student ID/Username</label>
                    <input type="text" id="studentId" name="studentId" required>
                </div>

                <!-- Email -->
                <div class="formgroup">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" required>
                </div>

                <!-- Password -->
                <div class="formgroup">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" required>
                </div>

                <!-- Confirm Password -->
                <div class="formgroup">
                    <label for="passwordAgain">Confirm Password</label>
                    <input type="password" id="passwordAgain" name="passwordAgain" required>
                </div>

                <!-- Role -->
                <div class="formgroup">
                    <label for="role">Role</label>
                    <select id="role" name="role" required>
                        <option value="">Select Role</option>
                        <option value="teacher">Teacher</option>
                        <option value="student">Student</option>
                    </select>
                </div>
        
                <!-- Submit Button -->
                <div class="btngroup">
                    <a href="./Loginpage.html">You already have an account?</a>
                    <button>Sign Up</button>
                </div>
            </form>
        
            <div id="responseMessage"></div>
        </div>
    </div>

   

    

    <script>
        // Hamburger menü kontrolü
        document.getElementById('menu-icon').addEventListener('click', function () {
            const navbar = document.querySelector('.navbar');
            navbar.classList.toggle('show'); // Menüyü aç/kapa
        });
    </script>
    

<script>
    document.getElementById('signUpForm').addEventListener('submit', async function (e) {
        e.preventDefault(); // Prevent default submit behavior

        // Get form values
        const username = e.target.username.value;
        const surname = e.target.surname.value;
        const studentId = e.target.studentId.value;
        const email = e.target.email.value;
        const password = e.target.password.value;
        const passwordAgain = e.target.passwordAgain.value;
        const role = e.target.role.value;

        // Password mismatch check
        if (password !== passwordAgain) {
            alert('Passwords do not match!');
            return;
        }

        // Send data to backend
        try {
            const response = await fetch('https://peaceful-forest-90255-fbe04ed90482.herokuapp.com/api/auth/register', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    username,
                    surname,
                    studentId,
                    email,
                    password,
                    role
                }),
            });

            const result = await response.json();

            if (response.status === 201) {
                // Redirect based on role
                if (role === 'teacher') {
                    window.location.href = '/teacherPage.html';  // Redirect to Teacher page
                } else if (role === 'student') {
                    window.location.href = '/studentPage.html';  // Redirect to Student page
                }
            } else {
                alert(result.message || 'An error occurred');
            }
        } catch (error) {
            console.error('Error:', error);
            alert('Something went wrong!');
        }
    });
    </script>
     <script src="home.js"></script>
</body>
</html>